/* FUNCIÓN PARA GESTIONAR NOTIFICACIONES... *******************************************************/
var route_notifications_messages = '';
var route_remove_messages = '';

$(document).ready(function () {
/* VER / OCULTAR NOTIFICACIONES GENERALES
   * Observamos el contenido (texto) de la etiqueta class="label-notifications",
   * el cual si es igual a 0 ocultaremos (añadimos o eliminamos la clase hidden).
   */
   if($(".label-notifications").text() == 0 ) {
     $(".label-notifications").addClass("hidden");
   } else {
     $(".label-notifications").removeClass("hidden");
   }

   /***********************************************************************************************/
  /* VER / OCULTAR NOTIFICACIONES MENSAJES
   * Observamos el contenido (texto) de la etiqueta class=".label-notifications-msg",
   * el cual si es igual a 0 ocultaremos (añadimos o eliminamos la clase hidden).
   */
   if($(".label-notifications-msg").text() == 0 ) {
    $(".label-notifications-msg").addClass("hidden");
  } else {
    $(".label-notifications-msg").removeClass("hidden");
  }

  notifications();/* CARGAMOS LA FUNCIÓN NOTIFICATIONS...***********/
  buttonsMensagge();

  /* REPETIMOS LA FUNCIÓN notifications(); CADA x milisegundos **********/
  setInterval(function () {
    notifications();
    }, 60000); // cada minuto se comprueban notificaciones

});

function notifications() {
  /* FUNCIÓN AJAX NOTIFICACIONES MENSAJES...*******************/
  $.ajax({
    url: route_notifications_messages,
    type: 'GET',
    success: function (response) {
      $(".label-notifications-msg").html(response);
// Colocamos / Quitamosla clase 'hidden' según response
if(response == 0 ) {
  $(".label-notifications-msg").addClass("hidden");
} else {
  $(".label-notifications-msg").removeClass("hidden");
}
}
});
}



function buttonsMensagge() {
  /* FUNCIÓN AJAX PARA BORRAR MENSAJES...*******************/
  $(".btn-img").unbind("click").click(function () {
   $(this).parent().find('.pub-image').fadeToggle();
 });

  $(".btn-delete-pub").unbind("click").click(function () {
   $(this).parent().parent().addClass('hidden');

   /* Damos funcionalidad al botón eliminar mensaje */
   $.ajax({
    url: route_remove_messages + "/" + $(this).attr("data-id"),
    type: 'GET',
    success: function (response) {
      console.log(response);
      $("#ajax-notifications").removeClass('hidden').html(response);
    }
  });
 });
}
